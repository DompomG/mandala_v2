from flask import Flask, render_template, request, redirect, url_for
from PIL import Image
import base64
import io



# Start flask app
app = Flask(__name__)

from prompt_dict import templates, prompt_dict
prompt = []   
def reconstruct_prompt(i, selection):
  while len(prompt) >= i:
    prompt.pop(len(prompt)-1)
  prompt.append(selection)


@app.route('/', methods=['GET', 'POSTe'])
def initial():
  return render_template('test.html')


@app.route('/animal', methods=['POST'])
def animal():
      i = 0;
      if (i==0) {
      return redirect(url_for(templates.get(sub_selection)))
      } else:
    return render_template(templates.get(selection))




@app.route('/display', methods=['POST', 'GET'])
def display():
    img = Image.open('test-image.png')

    data = io.BytesIO()
    img.save(data, format='PNG')
    encoded_img_data = base64.b64encode(data.getvalue())

    prompt_str = ""
    for x in prompt:
      prompt_str += x + ", "
    print('Current Prompt: ' + prompt_str)

    return render_template('display.html', img_data=encoded_img_data.decode('utf-8'), prompt_str=prompt_str)

if __name__ == '__main__':
  app.run(debug=True)


